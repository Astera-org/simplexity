# Unified API: Chain Topology - 3 mess3 + 2 tom_quantum
# Factor i depends on Factor i-1's emitted token (one-way conditional dependencies)

name: unified_chain_3mess3_2tomq
base_vocab_size: 432  # (3^3) * (4^2) = 27 * 16 = 432
vocab_size: ???

instance:
  _target_: simplexity.generative_processes.builder.build_chain_process_from_spec

  chain:
    # Factor 0: mess3 (unconditional, single variant)
    - component_type: hmm
      variants:
        - process_name: mess3
          x: 0.15
          a: 0.6

    # Factor 1: mess3 (4 variants based on Factor 0's token)
    - component_type: hmm
      variants:
        - process_name: mess3
          x: 0.15
          a: 0.6
        - process_name: mess3
          x: 0.11
          a: 0.79
        - process_name: mess3
          x: 0.5
          a: 0.6
        - process_name: mess3
          x: 0.5
          a: 0.21
      control_map: [2, 3, 0]  # 3 parent tokens -> 4 variants

    # Factor 2: mess3 (4 variants based on Factor 1's token)
    - component_type: hmm
      variants:
        - process_name: mess3
          x: 0.15
          a: 0.6
        - process_name: mess3
          x: 0.11
          a: 0.79
        - process_name: mess3
          x: 0.5
          a: 0.6
        - process_name: mess3
          x: 0.5
          a: 0.21
      control_map: [1, 3, 2]  # 3 parent tokens -> 4 variants

    # Factor 3: tom_quantum (4 variants based on Factor 2's token)
    - component_type: ghmm
      variants:
        - process_name: tom_quantum
          alpha: 1.0
          beta: 1.0
        - process_name: tom_quantum
          alpha: 1.0
          beta: 4.0
        - process_name: tom_quantum
          alpha: 1.0
          beta: 7.141428  # sqrt(51)
        - process_name: tom_quantum
          alpha: 1.0
          beta: 2.0
      control_map: [2, 0, 3]  # 3 parent tokens -> 4 variants

    # Factor 4: tom_quantum (4 variants based on Factor 3's token)
    - component_type: ghmm
      variants:
        - process_name: tom_quantum
          alpha: 1.0
          beta: 1.0
        - process_name: tom_quantum
          alpha: 1.0
          beta: 4.0
        - process_name: tom_quantum
          alpha: 1.0
          beta: 7.141428
        - process_name: tom_quantum
          alpha: 1.0
          beta: 2.0
      control_map: [1, 3, 0, 2]  # 4 parent tokens -> 4 variants

bos_token: ???
eos_token: null
batch_size: 1024