# 4.4. Logging

The Simplexity framework provides a flexible logging system to track experiment configurations, parameters, metrics, and tags. This is crucial for reproducibility, monitoring training progress, and comparing different experiment runs.

## Core Interface: `Logger` ABC

All logging functionalities are built around the abstract base class `simplexity.logging.logger.Logger`. Any concrete logger implementation must inherit from this class and implement its abstract methods:

*   **`log_config(self, config: DictConfig) -> None`:**
    *   Logs the entire experiment configuration (passed as an OmegaConf `DictConfig` object).
    *   This is typically called at the beginning of an experiment run.

*   **`log_metrics(self, step: int, metric_dict: Mapping[str, Any]) -> None`:**
    *   Logs a dictionary of metrics (e.g., `{"loss": 0.5, "accuracy": 0.8}`) at a specific training `step` (or epoch).
    *   Called periodically during the training loop and for validation results.

*   **`log_params(self, param_dict: Mapping[str, Any]) -> None`:**
    *   Logs a dictionary of hyperparameters or other relevant parameters of the experiment (e.g., model architecture details, dataset parameters).
    *   Often called at the start of an experiment.

*   **`log_tags(self, tag_dict: Mapping[str, Any]) -> None`:**
    *   Logs a dictionary of tags, which are typically key-value string pairs used for annotating or categorizing runs (e.g., `{"version": "v1.2", "dataset": "custom_data"}`).

*   **`close(self) -> None`:**
    *   Performs any necessary cleanup or finalization for the logger, such as closing file handles or ending active runs in tracking services.
    *   Called at the end of an experiment run.

## Concrete Logger Implementations

The framework provides several concrete logger implementations:

1.  **`simplexity.logging.file_logger.FileLogger`:**
    *   Logs all information (configs, params, metrics, tags) to a specified text file.
    *   Useful for simple, local logging.
    *   Configuration (`simplexity/configs/logging/file_logger.yaml`):
        ```yaml
        _target_: simplexity.configs.logging.config.FileLoggerConfig
        # Inherits _target_ for the instance from LoggingInstanceConfig
        # _target_: simplexity.logging.file_logger.FileLogger (This is set in the base config or by convention)
        file_path: "experiment_log.txt" # Path to the log file
        ```

2.  **`simplexity.logging.mlflow_logger.MLFlowLogger`:**
    *   Integrates with [MLflow Tracking](https://mlflow.org/docs/latest/tracking.html).
    *   Logs configs, parameters, metrics, and tags to an MLflow tracking server, enabling rich UI for comparing runs, visualizing metrics, and managing artifacts.
    *   Configuration (`simplexity/configs/logging/mlflow_logger.yaml`):
        ```yaml
        _target_: simplexity.configs.logging.config.MLFlowLoggerConfig
        experiment_name: "DefaultSimplexityExperiment"
        run_name: "my_run_${now:%Y%m%d-%H%M%S}" # Can use Hydra resolvers
        tracking_uri: "http://localhost:5000" # Or path to a local file-based store, e.g., "mlruns"
        # Note: actual MLFlowLogger instance is created via _target_ in LoggingInstanceConfig
        ```
        The `run_name` and `experiment_name` are often dynamically set in the main `experiment.yaml` using Hydra variable interpolation (e.g., based on model name, dataset, seed).

3.  **`simplexity.logging.print_logger.PrintLogger`:**
    *   A basic logger that simply prints all information to the standard output (console).
    *   Useful for quick debugging or when no persistent logging is needed.
    *   Configuration (`simplexity/configs/logging/print_logger.yaml`):
        ```yaml
        _target_: simplexity.configs.logging.config.PrintLoggerConfig
        # No specific parameters needed beyond the _target_ for the instance.
        ```

## Configuration and Usage

*   The desired logger is chosen in the main experiment configuration file (e.g., `experiment.yaml`) through Hydra's composition:
    ```yaml
    defaults:
      # ...
      - logging: mlflow_logger # or file_logger, print_logger
      # ...
    ```
*   The main script (`run_experiment.py`) instantiates the chosen logger using `simplexity.utils.hydra.typed_instantiate` based on the `logging.instance` configuration.
*   This logger instance is then passed to the `train` function, which uses its methods to log information at various stages.

## For Experimentalists

*   **Switching Loggers:** Change the `logging` default in `experiment.yaml` to select your preferred logger (e.g., from `mlflow_logger` to `print_logger` for a quick test).
*   **Configuring Logger Parameters:** Modify the specific YAML file for the logger (e.g., `simplexity/configs/logging/mlflow_logger.yaml` to change `tracking_uri` or `experiment_name`) or override from the command line:
    ```bash
    python simplexity/run_experiment.py logging.instance.tracking_uri="file:./my_mlruns" logging.instance.experiment_name="NewTest"
    ```

## For LLM Agents

*   Agents can configure logging by modifying the `logging` section of the Hydra configuration.
*   This includes selecting the logger type via the defaults list and setting its specific parameters (e.g., `file_path` for `FileLogger`, or `experiment_name`, `run_name`, `tracking_uri` for `MLFlowLogger`).
*   The path to logger parameters is typically `logging.instance.<parameter_name>`. 